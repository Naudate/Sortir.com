{% extends 'base.html.twig' %}

{% block title %}Détail de la sortie{% endblock %}

{% block body %}
    <div class="mx-auto max-w-7xl px-4 py-10 sm:px-6 sm:py-20 lg:px-8 grid sm:grid-cols-2">
        <div class="mx-auto max-w-2xl">
            <div>
                {% for message in app.flashes('success') %}
                    <p class="mt-1 text-sm leading-6 text-green-700">{{ message }}</p>
                {% endfor %}
                <div class="px-4 sm:px-0 grid gap-4 grid-cols-2">
                    <div>
                        <h3 class="text-base font-semibold leading-7 text-gray-900">
                            Informations de la sortie {{ sortie.nom }}
                        </h3>
                        <p class="mt-1 max-w-2xl text-sm leading-6 text-gray-500">
                            Détails de la sortie et des participants.
                        </p>
                    </div>
                </div>
                <div class="mt-6 border-t border-gray-100">
                    <dl class="divide-y divide-gray-100">
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Nom
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.nom }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Date de début
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.dateHeureDebut |date("d/m/Y H:i") }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Date de fin
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.dateHeureFin |date("d/m/Y H:i")}}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Durée
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ date_diff(sortie.dateHeureDebut|date("Y-m-d H:i:s"), sortie.dateHeureFin|date("Y-m-d H:i:s")) }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Date limite d'inscription
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.dateLimiteInscription |date("d/m/Y H:i")}}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Nombre de participants
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.participant | length }}/{{ sortie.nombreMaxParticipant }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Organisateur
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.organisateur.nom }} {{ sortie.organisateur.prenom }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Site
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.site.nom }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900">
                                Description
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.description }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900 grid sm:row-span-3 items-center">
                                Emplacement
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.lieu.ville.nom }} - {{ sortie.lieu.ville.codePostal }}
                            </dd>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.lieu.nom }}
                            </dd>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                {{ sortie.lieu.rue }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0">
                            <dt class="text-sm font-medium leading-6 text-gray-900 grid sm:row-span-3 items-center">
                                Coordonnées
                            </dt>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                Latitude :{{ sortie.lieu.latitude }}
                            </dd>
                            <dd class="mt-1 text-sm leading-6 text-gray-700 sm:col-span-2 sm:mt-0">
                                Longitude :{{ sortie.lieu.longitude }}
                            </dd>
                        </div>
                        <div class="px-4 py-6 sm:px-0 items-center justify-end">
                            <a href="{{ path('app_home') }}"
                               type="button"
                               class="inline-flex items-center rounded-md bg-gray-600
                               px-3 py-2 text-sm font-semibold text-white shadow-sm
                               hover:bg-gray-500 focus-visible:outline focus-visible:outline-2
                               focus-visible:outline-offset-2 focus-visible:outline-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg"
                                     fill="none"
                                     viewBox="0 0 24 24"
                                     stroke-width="1.5"
                                     stroke="currentColor"
                                     class="-ml-0.5 mr-1.5 w-5 h-5">
                                    <path stroke-linecap="round"
                                          stroke-linejoin="round"
                                          d="M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3" />
                                </svg>
                                Retour
                            </a>
                        </div>
                    </dl>
                </div>
            </div>
        </div>
        <div class="mx-auto w-full px-4 pb-6 sm:px-6 sm:pb-12 lg:px-8">
            <div class="mx-auto max-w-full">
                <div class="space-y-6">
                    {% if not sortie.participant %}
                        <p class="flex items-center justify-center text-red-700 font-bold">Aucun participants ici !!!</p>
                    {% else %}
                        <div class="relative overflow-x-auto shadow-md border-solid border-2 rounded-md border-gray-200">
                            <table class="w-full">
                                <thead class="text-md text-gray-700 uppercase bg-amber-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3">Pseudo</th>
                                    <th scope="col" class="px-6 py-3">Nom</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for participant in sortie.participant %}
                                    <tr class="bg-white border-b text-center">
                                        {% if sortie.organisateur.id  == app.user.id %}
                                        <td class="px-6 py-4 text-indigo-600 hover:underline"><a href="{{ path('user_details',
                                                { 'id': participant.id,
                                                  'idSortie': sortie.id}) }}">{{ participant.pseudo }}</a></td>
                                        {% else %}
                                        <td class="px-6 py-4">{{ participant.pseudo }}</td>
                                        {% endif %}
                                        <td class="px-6 py-4">{{ participant.nom }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
{% endblock %}